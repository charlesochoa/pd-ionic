{"version":3,"sources":["./src/app/modules/checkout/class/cart.ts","./src/app/modules/checkout/checkout.page.ts","./src/app/modules/checkout/checkout.page.html","./src/app/modules/checkout/checkout.module.ts","./src/app/modules/checkout/checkout.page.scss"],"names":[],"mappings":"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","file":"modules-checkout-checkout-module-es2015.js","sourcesContent":["import { Product } from \"../../menu/class/product\";\r\nimport { CartProduct } from \"./cart-product\";\r\nimport { User } from \"./user\";\r\n\r\nexport class Cart {\r\n  pk?: string;\r\n  creation_date?: Date;\r\n  cart_products?: CartProduct[];\r\n  ddp_user?: User;\r\n  subtotal?: number;\r\n  subtotalSinIva?: number;\r\n  delivery?: number;\r\n  discounts?: number;\r\n  iva?: number;\r\n  total?: number;\r\n\r\n  constructor() {\r\n    this.pk = \"\";\r\n    this.creation_date = null;\r\n    this.cart_products = [];\r\n    this.ddp_user = null;\r\n    this.subtotal = 0;\r\n    this.subtotalSinIva = 0;\r\n    this.delivery = 2.5;\r\n    this.discounts = 0.3;\r\n    this.iva = 0.21;\r\n  }\r\n}\r\n","import { Component, OnInit } from '@angular/core';\nimport { Router } from '@angular/router';\nimport { AlertController, ToastController } from '@ionic/angular';\nimport { AuthService } from '../login/auth.service';\nimport { CheckoutService } from './checkout.service';\nimport { Cart } from './class/cart';\nimport { CartProduct } from './class/cart-product';\nimport { User } from './class/user';\n\n@Component({\n  selector: 'app-checkout',\n  templateUrl: 'checkout.page.html',\n  styleUrls: ['checkout.page.scss']\n})\nexport class CheckoutPage {\n  user: User = null;\n  cart: Cart = new Cart();\n  cartProducts: CartProduct[] = [];\n  delay = true;\n  constructor(private checkoutService: CheckoutService,\n    private authService: AuthService,\n    private alertController: AlertController,\n    public toastController: ToastController,\n    private router: Router\n    ) {}\n  ionViewWillEnter(): void {\n    this.authService.getLocalUser().then(u => {\n      this.user = u;\n      console.log(this.user);\n      if (this.user.cartPk) {\n        this.checkoutService.getCart(this.user.cartPk).subscribe( c => {\n          this.cart.subtotal = c.subtotal;\n          this.cart.pk = c.pk;\n          this.calculateCart();\n          this.cartProducts = c.cart_products;\n          this.delay = false;\n        })\n      }\n    },\n    err => {\n      this.router.navigate(['']);\n    });\n  }\n  ionViewDidLeave(): void {\n    this.cartProducts = [];\n    this.cart = new Cart();\n    this.delay = true;\n  }\n\n  calculateCart() {\n    const iva = 0.21;\n    const discounts = 0.3;\n    const delivery = 2.5;\n    if (this.cart.subtotal > 0 ) {\n      this.cart.subtotalSinIva = this.cart.subtotal - this.cart.subtotal * iva;\n      this.cart.iva = this.cart.subtotal * iva;\n      this.cart.discounts = this.cart.subtotal * discounts * (-1.0);\n      this.cart.delivery = delivery;\n      this.cart.total = this.cart.subtotal - discounts * (-1.0) + delivery;\n    } else {\n      this.cart.subtotalSinIva = 0;\n      this.cart.iva = 0;\n      this.cart.discounts = 0;\n      this.cart.delivery = 0;\n      this.cart.total = 0;\n    }\n  }\n\n  modifyCart(event: any, index: number) {\n    this.cart.subtotal = event.cart.subtotal;\n    this.cart.pk = event.cart.pk;\n    if(event.cartProduct && event.cartProduct.count > 0) {\n      this.cartProducts[index].count = event.cartProduct.count;\n    } else {\n      this.cartProducts.splice(index, 1);\n    }\n    this.calculateCart();\n  }\n\n  async submit() {\n    const alert = await this.alertController.create({\n      cssClass: 'my-custom-class',\n      header: 'Ya estás casi listo!',\n      message: `¿Seguro que deseas realizar esta compra por un total de <strong>${this.cart.total} €</strong>?`,\n      buttons: [\n        {\n          text: 'Todavía no',\n          role: 'cancel',\n          cssClass: 'secondary',\n          handler: (blah) => {\n          }\n        }, {\n          text: 'Seguro!',\n          handler: () => {\n            this.checkoutService.makeTransaction( this.cart.pk).subscribe(async t => {\n              const toast = await this.toastController.create({\n                message: `¡Prueba finalizada! <strong>¡Muchisimas gracias!</strong> revisa tu correo y en cuanto puedas nos comentas qué tal te pareció nuestra propuesta!`,\n                duration: 10000,\n                position: 'middle'\n              });\n              await this.authService.clear();\n              toast.present();\n              this.router.navigate(['']);\n            }, async err => {\n              const toast = await this.toastController.create({\n                message: 'Estamos teniendo problemas técnicos. Por favor, intente nuevamente.',\n                duration: 1000,\n                color: 'danger'\n              });\n              toast.present();\n            });\n          }\n        }\n      ]\n    });\n\n    alert.present();\n  }\n}\n","export default \"<ion-header background=\\\"danger\\\">\\n  <ion-toolbar>\\n      <ion-title slot=\\\"start\\\">\\n        <img\\n            src=\\\"../../../assets/images/icon.jpg\\\" height=\\\"40px\\\"\\n          />\\n      </ion-title>\\n    <ion-title slot=\\\"start\\\">\\n        <img\\n            src=\\\"../../../assets/images/letters.png\\\" height=\\\"20px\\\"\\n          />\\n    </ion-title>\\n  </ion-toolbar>\\n</ion-header>\\n\\n\\n<ion-content [fullscreen]=\\\"true\\\">\\n  <ion-header collapse=\\\"condense\\\">\\n    <ion-toolbar>\\n      <ion-title size=\\\"large\\\">Checkout</ion-title>\\n    </ion-toolbar>\\n  </ion-header>\\n  <ion-list *ngIf=\\\"cartProducts\\\" lines=\\\"none\\\">\\n    <ion-item-group>\\n      <ion-item-divider>\\n        <ion-label>Resumen de compra</ion-label>\\n      </ion-item-divider>\\n      <list-item *ngFor=\\\"let item of cartProducts; let i = index\\\"\\n        (cartChange)=\\\"modifyCart($event, i)\\\"\\n        [cartProduct]= \\\"item\\\"\\n        [cart]= \\\"cart\\\"\\n        class=\\\"item animated delay-0{{ i+3 }}s\\\"\\n        [angularShape]=\\\"user.angularShape\\\">\\n      </list-item>\\n      <ion-item lines=\\\"none\\\" *ngIf=\\\"cartProducts.length==0\\\" class=\\\"item animated delay-0{{ 3 }}s\\\">\\n        <label color=\\\"light\\\" class=\\\"summary-label\\\" slot=\\\"primary\\\">Aún no has agregado ninguna pizza al carrito.</label>\\n      </ion-item>\\n    </ion-item-group>\\n  </ion-list>\\n\\n</ion-content>\\n<ion-footer *ngIf=\\\"cart && !delay\\\">\\n  <ion-item-group>\\n    <ion-item-divider>\\n      <ion-label>Subtotal</ion-label>\\n    </ion-item-divider>\\n    <ion-item lines=\\\"none\\\">\\n\\n      <ion-label>Subtotal productos</ion-label>\\n      <ion-label class=\\\"summary-label\\\">{{cart.subtotal | number: '1.0-2'}} €</ion-label>\\n    </ion-item>\\n    <ion-item lines=\\\"none\\\">\\n\\n      <ion-label>IVA</ion-label>\\n      <ion-label class=\\\"summary-label\\\">{{cart.iva | number: '1.0-2'}} €</ion-label>\\n    </ion-item>\\n    <ion-item lines=\\\"none\\\">\\n      <ion-label color=\\\"success\\\">Descuentos</ion-label>\\n      <ion-label class=\\\"summary-label\\\" color=\\\"success\\\">{{cart.discounts | number: '1.0-2'}} €</ion-label>\\n    </ion-item>\\n\\n    <ion-item lines=\\\"none\\\">\\n      <ion-label>Envío</ion-label>\\n      <ion-label class=\\\"summary-label\\\">{{cart.delivery }} €</ion-label>\\n    </ion-item>\\n\\n    <ion-item lines=\\\"none\\\">\\n      <ion-label><strong>TOTAL</strong></ion-label>\\n      <ion-label class=\\\"summary-label\\\"><strong>{{ cart.total | number: '1.0-2'}} €</strong></ion-label>\\n    </ion-item>\\n    <ion-button *ngIf=\\\"user\\\"\\n      [style.color]=\\\"secondary\\\"\\n      [style.border]=\\\"secondary\\\"\\n      expand=\\\"block\\\"\\n      [class.rounded-shape]=\\\"!user.angularShape\\\" [class.angular-shape]=\\\"user.angularShape\\\"\\n      (click)=\\\"submit()\\\"\\n      >\\n      Realizar el Pago y a Disfrutar!\\n    </ion-button>\\n  </ion-item-group>\\n\\n</ion-footer>\\n\";","import { IonicModule } from '@ionic/angular';\nimport { RouterModule } from '@angular/router';\nimport { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport { CheckoutPage } from './checkout.page';\nimport { SharedModule } from '../../shared.module';\n\n\n@NgModule({\n  imports: [\n    IonicModule,\n    CommonModule,\n    FormsModule,\n    SharedModule,\n    RouterModule.forChild([{ path: '', component: CheckoutPage }])\n  ],\n  declarations: [CheckoutPage]\n})\nexport class CheckoutPageModule {}\n","export default \"ion-header ion-toolbar {\\n  --background: var(--ion-color-danger);\\n}\\n\\n.item {\\n  display: block;\\n  cursor: pointer;\\n  -webkit-animation-name: fadeInUp;\\n  animation-name: fadeInUp;\\n}\\n\\n.angular-shape {\\n  --border-radius: 0px ;\\n  border-radius: 0px;\\n}\\n\\n.rounded-shape {\\n  --border-radius: 40px ;\\n  border-radius: 40px;\\n}\\n\\n.summary-label {\\n  text-align: right;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uXFwuLlxcLi5cXC4uXFxjaGVja291dC5wYWdlLnNjc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBR0U7RUFDRSxxQ0FBQTtBQUZKOztBQU1BO0VBQ0UsY0FBQTtFQUNBLGVBQUE7RUFDQSxnQ0FBQTtFQUNBLHdCQUFBO0FBSEY7O0FBTUE7RUFDRSxxQkFBQTtFQUNBLGtCQUFBO0FBSEY7O0FBTUE7RUFDRSxzQkFBQTtFQUNBLG1CQUFBO0FBSEY7O0FBTUE7RUFDRSxpQkFBQTtBQUhGIiwiZmlsZSI6ImNoZWNrb3V0LnBhZ2Uuc2NzcyIsInNvdXJjZXNDb250ZW50IjpbIlxyXG5cclxuaW9uLWhlYWRlciB7XHJcbiAgaW9uLXRvb2xiYXIge1xyXG4gICAgLS1iYWNrZ3JvdW5kOiB2YXIoLS1pb24tY29sb3ItZGFuZ2VyKTtcclxuICB9XHJcbn1cclxuXHJcbi5pdGVtIHtcclxuICBkaXNwbGF5OiBibG9jaztcclxuICBjdXJzb3I6IHBvaW50ZXI7XHJcbiAgLXdlYmtpdC1hbmltYXRpb24tbmFtZTogZmFkZUluVXA7XHJcbiAgYW5pbWF0aW9uLW5hbWU6IGZhZGVJblVwO1xyXG59XHJcblxyXG4uYW5ndWxhci1zaGFwZSB7XHJcbiAgLS1ib3JkZXItcmFkaXVzOiAwcHggO1xyXG4gIGJvcmRlci1yYWRpdXM6IDBweCA7XHJcbn1cclxuXHJcbi5yb3VuZGVkLXNoYXBlIHtcclxuICAtLWJvcmRlci1yYWRpdXM6IDQwcHggO1xyXG4gIGJvcmRlci1yYWRpdXM6IDQwcHggO1xyXG59XHJcblxyXG4uc3VtbWFyeS1sYWJlbCB7XHJcbiAgdGV4dC1hbGlnbjogcmlnaHQ7XHJcbn1cclxuIl19 */\";"],"sourceRoot":"webpack:///"}